<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Stream Torrent Video</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        background-color: #f4f4f4;
        padding: 20px;
      }
      h1 {
        text-align: center;
      }
      .container {
        max-width: 600px;
        margin: 0 auto;
        text-align: center;
      }
      .input-group {
        margin-bottom: 15px;
      }
      input[type="text"] {
        width: 80%;
        padding: 10px;
        font-size: 16px;
      }
      button {
        padding: 10px 15px;
        font-size: 16px;
        cursor: pointer;
      }
      video {
        width: 100%;
        max-width: 600px;
        margin-top: 20px;
        display: none;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Stream Torrent via Magnet Link</h1>

      <div class="input-group">
        <input type="text" id="magnet" placeholder="Enter magnet link" />
        <button id="streamButton">Stream</button>
      </div>

      <video id="video" controls></video>

      <p id="statusMessage"></p>
    </div>

    <script>
      const streamButton = document.getElementById("streamButton");
      const magnetInput = document.getElementById("magnet");
      const videoElement = document.getElementById("video");
      const statusMessage = document.getElementById("statusMessage");

      streamButton.addEventListener("click", function () {
        const magnetLink = magnetInput.value;
        if (!magnetLink) {
          alert("Please enter a valid magnet link.");
          return;
        }

        // Send the magnet link to the API to initiate streaming
        statusMessage.textContent = "Loading stream...";
        const streamUrl = `/stream?magnetURI=${encodeURIComponent(magnetLink)}`;

        // Set the video src to the stream URL
        videoElement.src = streamUrl; // The stream URL should respond to Range requests
        videoElement.style.display = "block";
        videoElement.play(); // Start playing the video after setting the src
        statusMessage.textContent = "";
      });
    </script>
  </body>
</html>
